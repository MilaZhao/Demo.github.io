<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åº·å¯¶å»šè—æ™‚ä»£ Knorr Pro v22</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <style>
        /* --- 1. Design Tokens --- */
        :root {
            --primary: #00652B; --primary-light: #E6F0EA;
            --secondary: #FF5700; --secondary-light: #FFF0E5;
            --bg-body: #F7F9F8; --surface: #FFFFFF;
            --text-main: #2D3330; --text-body: #4A524F; --text-muted: #8C9692;
            
            --sp-xs: 4px; --sp-sm: 8px; --sp-md: 16px; --sp-lg: 24px;
            --bottom-nav-height: 80px;
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.04);
            --shadow-md: 0 8px 24px rgba(0,101,43,0.08);
            --radius-lg: 16px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg-body); color: var(--text-main); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; padding-bottom: var(--bottom-nav-height); line-height: 1.6; }

        /* --- 2. Shared Components --- */
        header { background: var(--surface); position: sticky; top: 0; z-index: 90; box-shadow: var(--shadow-sm); }
        .header-top { background: var(--primary); padding: 8px 16px; height: 56px; display: flex; align-items: center; gap: 16px; color: white; }
        .search-bar { flex: 1; background: rgba(255,255,255,0.15); border-radius: 30px; height: 36px; display: flex; align-items: center; padding: 0 16px; font-size: 14px; }
        .icon-btn { cursor: pointer; color: white; }

        .tab-bar { padding: 12px 0; background: var(--surface); border-bottom: 1px solid #eee; }
        .scrolling-wrapper { display: flex; overflow-x: auto; gap: 8px; padding: 0 16px; scrollbar-width: none; }
        .tab-chip { padding: 6px 16px; border-radius: 20px; font-size: 13px; font-weight: 500; color: var(--text-muted); background: #F5F5F5; white-space: nowrap; transition: 0.2s; cursor: pointer; border: 1px solid transparent; }
        .tab-chip.active { background: var(--primary-light); color: var(--primary); font-weight: 700; border-color: rgba(0,101,43,0.2); }

        .section-header { padding: 24px 16px 12px; display: flex; justify-content: space-between; align-items: center; }
        .section-title { font-size: 18px; font-weight: 700; display: flex; align-items: center; gap: 8px; }
        .card-scroll-container { display: flex; overflow-x: auto; gap: 16px; padding: 0 16px 16px; scrollbar-width: none; }
        
        .fade-in { animation: fadeIn 0.3s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- 3. Home & List Styles (v20) --- */
        .card { background: var(--surface); border-radius: 16px; overflow: hidden; box-shadow: var(--shadow-sm); display: flex; flex-direction: column; cursor: pointer; position: relative; min-width: 220px; }
        .card:active { transform: scale(0.98); transition: 0.1s; }
        .card-img-wrapper { position: relative; padding-top: 60%; background: #eee; }
        .card-img { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }
        .card-badge { position: absolute; top: 8px; left: 8px; background: rgba(0,0,0,0.7); backdrop-filter: blur(4px); color: white; font-size: 10px; font-weight: 700; padding: 4px 8px; border-radius: 4px; }
        .card-content { padding: 12px; flex: 1; display: flex; flex-direction: column; }
        .card-title { font-weight: 700; font-size: 15px; margin-bottom: 8px; line-height: 1.3; }
        .card-meta { display: flex; gap: 4px; flex-wrap: wrap; margin-top: auto; }
        .meta-tag { font-size: 10px; background: #F0F2F1; padding: 2px 6px; border-radius: 4px; color: #666; display: flex; align-items: center; gap: 2px; }

        .list-card { background: var(--surface); margin: 0 16px 12px; padding: 16px; border-radius: 12px; box-shadow: var(--shadow-sm); display: flex; gap: 16px; align-items: flex-start; cursor: pointer; position: relative; }
        .list-card-img { width: 80px; height: 80px; border-radius: 8px; object-fit: cover; background: #eee; flex-shrink: 0; }
        .rank-badge { position: absolute; top: 0; left: 0; width: 24px; height: 24px; border-radius: 12px 0 12px 0; display: flex; justify-content: center; align-items: center; font-weight: 900; font-size: 12px; color: #fff; z-index: 2; }
        .rank-1 { background: #FFD700; color: #333; }
        .rank-2 { background: #C0C0C0; color: #333; }
        .rank-3 { background: #CD7F32; }
        
        .ranking-tabs { display: flex; border-bottom: 1px solid #eee; margin-bottom: 12px; }
        .ranking-tab { flex: 1; text-align: center; padding: 12px; font-size: 14px; color: var(--text-muted); cursor: pointer; border-bottom: 2px solid transparent; }
        .ranking-tab.active { color: var(--primary); font-weight: 700; border-color: var(--primary); }

        /* --- 4. Recipe Page: Banner & Wizard Buttons --- */
        .chef-banner { margin: 16px; background: linear-gradient(135deg, #1a1a1a, #333); border-radius: 16px; padding: 20px; color: white; display: flex; align-items: center; justify-content: space-between; overflow: hidden; position: relative; box-shadow: var(--shadow-md); cursor: pointer; }
        .chef-banner::after { content:''; position:absolute; right:-20px; top:-20px; width:100px; height:100px; background:var(--secondary); border-radius:50%; opacity:0.15; }
        
        .strategy-cta-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 0 16px 8px; margin-bottom: 8px; }
        .strategy-btn { background: var(--surface); border-radius: 16px; padding: 16px; display: flex; flex-direction: column; align-items: center; gap: 8px; box-shadow: var(--shadow-sm); cursor: pointer; border: 1px solid #f0f0f0; transition:0.1s;}
        .strategy-btn:active { transform: scale(0.98); background: #fafafa; }
        .btn-icon-circle { width: 40px; height: 40px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 24px; margin-bottom: 4px; }
        .btn-change .btn-icon-circle { background: #E3F2FD; color: #1565C0; }
        .btn-fast .btn-icon-circle { background: #FFF3E0; color: #E65100; }
        .recipe-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; padding: 0 16px 24px; }

        /* --- 5. Scan Page (v19) --- */
        .scan-container { height: calc(100vh - 80px); background: #121212; display: flex; flex-direction: column; position: relative; }
        .scan-viewfinder { flex: 1; display: flex; justify-content: center; align-items: center; position: relative; }
        .scan-frame { width: 260px; height: 260px; border: 2px solid var(--secondary); border-radius: 24px; position: relative; box-shadow: 0 0 0 4000px rgba(0,0,0,0.7); }
        .scan-frame::after { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: var(--secondary); box-shadow: 0 0 10px var(--secondary); animation: scanMove 2s infinite linear; }
        @keyframes scanMove { 0% { top: 0; } 50% { top: 100%; } 100% { top: 0; } }
        
        .scan-controls { position: absolute; top: 20px; right: 20px; z-index: 10; }
        .toggle-btn { background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); padding: 8px 16px; border-radius: 20px; color: white; font-size: 12px; font-weight: 600; display: flex; align-items: center; gap: 8px; cursor: pointer; }
        .toggle-switch { width: 32px; height: 18px; background: rgba(0,0,0,0.3); border-radius: 10px; position: relative; transition: 0.3s; border:1px solid rgba(255,255,255,0.5); }
        .toggle-switch.on { background: var(--secondary); border-color:var(--secondary); }
        .toggle-switch::after { content:''; position: absolute; top: 2px; left: 2px; width: 12px; height: 12px; background: white; border-radius: 50%; transition: 0.3s; }
        .toggle-switch.on::after { transform: translateX(14px); }

        .rewards-panel { background: white; border-radius: 24px 24px 0 0; padding: 24px 20px; z-index: 10; }
        .progress-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 8px; }
        .progress-track { height: 8px; background: #eee; border-radius: 4px; overflow: hidden; margin-bottom: 20px; margin-top: 8px; }
        .progress-fill { width: 85%; height: 100%; background: linear-gradient(90deg, var(--primary), #4CAF50); border-radius: 4px; }
        .instant-rewards { display: flex; gap: 12px; }
        .reward-card { flex: 1; border: 1px solid #eee; padding: 12px; border-radius: 12px; text-align: center; cursor: pointer; transition: 0.2s; }
        .reward-card:active { border-color: var(--primary); background: var(--primary-light); }
        
        .toast { position: absolute; bottom: 200px; left: 50%; transform: translateX(-50%); background: rgba(0, 101, 43, 0.95); color: white; padding: 12px 24px; border-radius: 30px; font-size: 14px; font-weight: 600; display: flex; align-items: center; gap: 8px; opacity: 0; transition: 0.3s; pointer-events: none; z-index: 20; box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
        .toast.show { opacity: 1; transform: translateX(-50%) translateY(-10px); }

        /* --- 6. Wizard Modal (v12 Style) --- */
        #wizard-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; display: none; justify-content: center; align-items: flex-end; backdrop-filter: blur(4px); }
        .wizard-container { background: var(--surface); width: 100%; border-radius: 24px 24px 0 0; padding: 32px 24px; max-height: 90vh; overflow-y: auto; position: relative; animation: slideUp 0.3s cubic-bezier(0.2, 0.8, 0.2, 1); }
        .wizard-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
        .wizard-progress { display: flex; gap: 6px; margin-bottom: 24px; }
        .progress-bar { height: 6px; flex: 1; background: #f0f0f0; border-radius: 3px; transition: 0.3s; }
        .progress-bar.active { background: var(--secondary); }
        .wizard-option-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .wizard-option { padding: 20px; border: 2px solid #f0f0f0; border-radius: 16px; text-align: center; font-weight: 700; color: var(--text-body); cursor: pointer; transition: 0.2s; background: #fff; font-size: 16px; }
        .wizard-option:active { border-color: var(--primary); background: var(--primary-light); color: var(--primary); transform: scale(0.98); }
        
        /* Result Page Elements */
        .result-context { background: var(--primary-light); padding: 20px; margin: 16px; border-radius: 16px; display: flex; flex-direction: column; gap: 12px; border: 1px solid rgba(0,101,43,0.1); }
        .result-chips { display: flex; flex-wrap: wrap; gap: 8px; }
        .result-chip { background: white; color: var(--text-body); padding: 6px 14px; border-radius: 20px; font-size: 13px; font-weight: 600; border: 1px solid rgba(0,0,0,0.05); }

        /* --- 7. Detail View (Rich & UX) --- */
        #detail-view { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--surface); z-index: 3000; overflow-y: auto; display: none; }
        .detail-hero { height: 320px; position: relative; }
        .detail-hero img { width: 100%; height: 100%; object-fit: cover; }
        .detail-back { position: fixed; top: 24px; left: 20px; width: 44px; height: 44px; background: rgba(255,255,255,0.95); border-radius: 50%; display: flex; justify-content: center; align-items: center; z-index: 3010; cursor: pointer; box-shadow: var(--shadow-md); }
        .detail-body { padding: 32px 24px; background: white; border-radius: 32px 32px 0 0; margin-top: -40px; position: relative; min-height: 80vh; padding-bottom: 100px; }
        
        .progress-bar-top { position: fixed; top: 0; left: 0; width: 100%; height: 6px; background: #eee; z-index: 3020; display:none; }
        .progress-bar-fill { height: 100%; background: var(--primary); width: 0%; transition: width 0.1s; }

        .info-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-bottom: 32px; }
        .info-box { background: #FAFAFA; border: 1px solid #EEE; border-radius: 16px; padding: 16px 12px; text-align: center; }
        
        .section-header-detail { font-size: 20px; font-weight: 700; color: var(--text-main); margin: 40px 0 20px; display: flex; align-items: center; gap: 8px; padding-left: 12px; border-left: 4px solid var(--secondary); }
        .checkbox-item { display: flex; align-items: center; gap: 16px; padding: 12px 0; border-bottom: 1px solid #f9f9f9; cursor: pointer; }
        .checkbox-circle { width: 24px; height: 24px; border: 2px solid #ddd; border-radius: 50%; transition: 0.2s; position: relative; }
        .checkbox-circle.checked { background: var(--primary); border-color: var(--primary); }
        .checkbox-circle.checked::after { content:'âœ“'; color:white; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-size:14px; }
        
        /* Google Maps Comments */
        .comment-section { margin-top: 40px; border-top: 1px solid #eee; padding-top: 24px; }
        .comment-item { display: flex; gap: 16px; margin-bottom: 24px; border-bottom: 1px solid #f5f5f5; padding-bottom: 16px; }
        .comment-avatar { width: 40px; height: 40px; background: #81C784; color:white; border-radius: 50%; display:flex; justify-content:center; align-items:center; font-weight:700; flex-shrink:0; }
        .comment-name { font-weight: 700; font-size: 14px; margin-bottom: 2px; }
        .comment-meta { font-size: 12px; color: #777; display: flex; gap: 8px; margin-bottom: 8px; }
        .comment-stars { color: #FBC02D; letter-spacing: 1px; }
        .comment-text { font-size: 14px; color: #444; line-height: 1.5; }
        .comment-actions { margin-top: 12px; display: flex; gap: 12px; }
        .action-chip { font-size: 12px; color: #555; border: 1px solid #ddd; padding: 4px 12px; border-radius: 16px; display: flex; align-items: center; gap: 4px; cursor: pointer; }
        
        .related-products { margin-top: 40px; border-top: 1px solid #eee; padding-top: 24px; }
        .rp-card { min-width: 120px; border: 1px solid #eee; border-radius: 12px; padding: 16px 12px; text-align: center; }
        .rp-img { width: 64px; height: 64px; margin: 0 auto 12px; background: #eee; border-radius: 8px; }

        /* Nav */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; height: var(--bottom-nav-height); background: rgba(255,255,255,0.98); backdrop-filter: blur(20px); border-top: 1px solid #eee; display: flex; justify-content: space-around; padding-top: 12px; z-index: 1000; }
        .nav-item { display: flex; flex-direction: column; align-items: center; gap: 6px; color: var(--text-muted); cursor: pointer; flex: 1; transition: 0.2s; }
        .nav-item.active { color: var(--primary); }
        .scan-circle { width: 60px; height: 60px; background: var(--primary); border-radius: 50%; box-shadow: 0 8px 20px rgba(0, 101, 43, 0.4); display: flex; justify-content: center; align-items: center; color: white; border: 4px solid var(--bg-body); position: relative; top: -32px; }
    </style>
</head>
<body>

    <div id="app-root"></div>

    <div id="wizard-overlay">
        <div class="wizard-container">
            <div class="wizard-header">
                <span class="wizard-title" id="wizard-title" style="font-size:20px;font-weight:700;"></span>
                <span class="material-symbols-outlined" onclick="closeWizard()" style="cursor:pointer;padding:8px;">close</span>
            </div>
            <div class="wizard-progress" id="wizard-progress" style="display:flex;gap:6px;margin-bottom:24px;"></div>
            <div id="wizard-content"></div>
            <div id="wizard-loading" style="display:none; text-align:center; padding:60px 0;">
                <span class="material-symbols-outlined" style="font-size:56px; color:var(--secondary); animation:spin 1s linear infinite;">progress_activity</span>
                <p style="font-weight:700; color:var(--primary); margin-top:24px; font-size:18px;">æ­£åœ¨æ¨è–¦æœ€ä½³æ–¹æ¡ˆ</p>
                <style>@keyframes spin { 100% { transform: rotate(360deg); } }</style>
            </div>
        </div>
    </div>

    <div id="detail-view" onscroll="updateProgress()">
        <div class="progress-bar-top"><div class="progress-bar-fill" id="read-progress"></div></div>
        <div class="detail-back" onclick="closeDetail()"><span class="material-symbols-outlined">arrow_back</span></div>
        <div class="detail-hero"><img id="detail-img" src=""></div>
        <div class="detail-body" id="detail-content"></div>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="router('home')"><span class="material-symbols-outlined">home</span><span style="font-size:10px;">é¦–é </span></div>
        <div class="nav-item" onclick="router('info')"><span class="material-symbols-outlined">article</span><span style="font-size:10px;">é¤é£²æƒ…å ±</span></div>
        <div class="nav-item scan-btn" onclick="router('scan')"><div class="scan-circle"><span class="material-symbols-outlined" style="font-size:28px;">qr_code_scanner</span></div><span style="font-size:10px;font-weight:700;color:var(--primary);margin-top:4px;">é›†é»</span></div>
        <div class="nav-item" onclick="router('recipes')"><span class="material-symbols-outlined">menu_book</span><span style="font-size:10px;">å°ˆæ¥­é£Ÿè­œ</span></div>
        <div class="nav-item" onclick="router('shop')"><span class="material-symbols-outlined">shopping_cart</span><span style="font-size:10px;">è³¼è²·</span></div>
    </nav>

    <script>
        // --- Data ---
        const db = {
            recipes: [
                { id: 1, title: "éº»è¾£æ°´ç…®é­š", category: ["all","chef","spicy"], type: "åå»š", date: "1æœˆ12æ—¥", img: "https://placehold.co/800x600/FF5700/FFF?text=Spicy+Fish", 
                  stats: {time: "15åˆ†", cost: "$45", diff: "ä¸­"}, ranking: 1, reviews: 24,
                  desc: "æ±ŸæŒ¯èª ä¸»å»šæ¨è–¦æŠ€æ³•ï¼Œé€éä½æº«æ…¢ç…®é–ä½è‚‰æ±ï¼Œæ­é…åº·å¯¶éº»è¾£é†¬èˆ‡ç‰¹è£½èŠ±æ¤’æ²¹ï¼Œå‘ˆç¾å¤šå±¤æ¬¡é¦™æ°£ã€‚é©åˆè¿½æ±‚ç²¾ç·»å£æ„Ÿçš„é¤å»³ã€‚",
                  ingredients: ["é±¸é­šç‰‡ 400g", "è±†èŠ½èœ 200g", "åº·å¯¶éº»è¾£é†¬ 3å¤§åŒ™", "åº·å¯¶é›ç²‰ 1å°åŒ™", "èŠ±æ¤’ç²’ 1å¤§åŒ™"],
                  steps: [{t:"é†ƒè£½",c:"é±¸é­šç‰‡åˆ‡è–„ç‰‡ï¼Œç”¨é¹½ã€å¤ªç™½ç²‰é†ƒè£½10åˆ†é˜ã€‚"}, {t:"ç‚’é†¬ç…®æ¹¯",c:"èµ·æ²¹é‹çˆ†é¦™éº»è¾£é†¬ï¼ŒåŠ å…¥é«˜æ¹¯ç…®æ»¾ã€‚"}, {t:"æ·‹æ²¹çˆ†é¦™",c:"é­šç‰‡ç…®ç†Ÿç››ç›¤ã€‚å¦èµ·æ²¹é‹çˆ†é¦™èŠ±æ¤’ã€ä¹¾è¾£æ¤’ï¼Œæ·‹åœ¨é­šç‰‡ä¸Šã€‚"}],
                  tips: "å¤ªç™½ç²‰èƒ½è®“é­šè‚‰æ›´æ»‘å«©ï¼Œé†ƒè£½æ™‚åŠ ä¸€é»è›‹ç™½æ•ˆæœæ›´å¥½ã€‚", qa: [{q:"ä¸åƒè¾£?",a:"æ”¹ç•ªèŒ„æ¹¯åº•ã€‚"}], multiUse: [{name:"éº»è¾£é‹",cost:"$30"},{name:"å£æ°´é›",cost:"$50"}],
                  comments: [{id:1, user:"ç‹å¤§å»š", star:5, date:"2å¤©å‰", text:"å®¢äººåæ‡‰å¾ˆå¥½ï¼Œå‡ºé¤å¾ˆå¿«ï¼"}, {id:2, user:"æåº—é•·", star:4, date:"1é€±å‰", text:"æˆæœ¬æ§åˆ¶å¾—å®œã€‚"}]
                },
                { id: 2, title: "æ³°å¼æ‰“æ‹‹è±¬", category: ["all","lazy","low_cost"], type: "æ‡¶äººåŒ…", date: "1æœˆ10æ—¥", img: "https://placehold.co/800x600/00652B/FFF?text=Thai+Pork",
                  stats: {time: "10åˆ†", cost: "$38", diff: "æ˜“"}, ranking: 2, reviews: 56,
                  desc: "ä¸€é†¬æå®šè¤‡é›œèª¿å‘³ï¼Œé©åˆå•†æ¥­åˆé¤ã€‚",
                  ingredients: ["è±¬çµè‚‰ 150g", "ä¹å±¤å¡” 1æŠŠ", "åº·å¯¶æ³°å¼æ‰“æ‹‹é†¬ 2å¤§åŒ™", "é­šéœ² 1å°åŒ™"],
                  steps: [{t:"ç‚’çµè‚‰",c:"ç†±é‹çˆ†é¦™è’œæœ«ï¼ŒåŠ å…¥è±¬çµè‚‰ç‚’è‡³è®Šè‰²ã€‚"}, {t:"åŠ é†¬æ‹Œç‚’",c:"åŠ å…¥æ‰“æ‹‹é†¬æ‹Œå‹»ï¼Œèµ·é‹å‰æ”¾ä¹å±¤å¡”ã€‚"}],
                  tips: "å¤§ç«å¿«ç‚’æ‰æœ‰é‘Šæ°£ï¼Œçµè‚‰æ‰ä¸æœƒå‡ºæ°´ã€‚", qa: [{q:"ç”¨é›è‚‰?",a:"å¯ä»¥ã€‚"}],
                  multiUse: [{name:"ç‚’æ²³ç²‰",cost:"$32"}, {name:"æ¶¼æ‹Œæµ·é®®",cost:"$45"}], comments: [{id:3, user:"é™³å¸«å‚…", star:5, date:"3å¤©å‰", text:"çœŸçš„åªè¦ä¸€ç½é†¬ã€‚"}]
                }
            ],
            info: [
                { id: 101, title: "éŸ“å¼ç™¼é…µé†¬æ‡‰ç”¨è¶¨å‹¢", category: "trend", date: "1æœˆ11æ—¥", isNew: true, img: "https://placehold.co/800x600/eee/333?text=Korean+Sauce",
                  views: "1.2k", ranking: 1, tldr: ["å¯å–ä»£å‚³çµ±é†ƒæ–™","æˆæœ¬é™ä½30%"], 
                  content: "è¿‘å¹´éŸ“å¼æ–™ç†é¢¨æ½®å¸­æ²å…¨çƒ... (æ¨¡æ“¬è¶…é•·æ–‡) æ ¹æ“š 2024 é¤é£²è¶¨å‹¢å ±å‘Šï¼Œä½¿ç”¨ç™¼é…µèª¿å‘³å“çš„é¤å»³æ¯”å‚³çµ±é¤å»³å¤šå‡º 35% çš„å›å®¢ç‡ã€‚<br><br>éŸ“å¼ç™¼é…µé†¬çš„ç¨ç‰¹ä¹‹è™•åœ¨æ–¼å…¶æ·±å±¤çš„é®®å‘³...<br><br>å»šå¸«å¯ä»¥åˆ©ç”¨å®ƒä¾†é†ƒè£½è‚‰é¡...<br><br>çµè«–æ˜¯é€™æ˜¯ä¸€å€‹é«˜æ€§åƒ¹æ¯”çš„é¸æ“‡...<br><br>(é‡è¤‡å…§å®¹ä»¥å¢åŠ é•·åº¦)<br><br>è¿‘å¹´éŸ“å¼æ–™ç†é¢¨æ½®å¸­æ²å…¨çƒ... æ ¹æ“š 2024 é¤é£²è¶¨å‹¢å ±å‘Šï¼Œä½¿ç”¨ç™¼é…µèª¿å‘³å“çš„é¤å»³æ¯”å‚³çµ±é¤å»³å¤šå‡º 35% çš„å›å®¢ç‡ã€‚<br><br>éŸ“å¼ç™¼é…µé†¬çš„ç¨ç‰¹ä¹‹è™•åœ¨æ–¼å…¶æ·±å±¤çš„é®®å‘³...<br><br>å»šå¸«å¯ä»¥åˆ©ç”¨å®ƒä¾†é†ƒè£½è‚‰é¡...<br><br>çµè«–æ˜¯é€™æ˜¯ä¸€å€‹é«˜æ€§åƒ¹æ¯”çš„é¸æ“‡..." },
                { id: 102, title: "é›ç²‰å–ä»£é«˜æ¹¯æˆæœ¬è¡“", category: "manage", date: "1æœˆ08æ—¥", isNew: true, img: "https://placehold.co/800x600/333/fff?text=Chicken+Powder",
                  views: "3.5k", ranking: 2, tldr: ["å‚³çµ±ç†¬æ¹¯è²»æ™‚","é›ç²‰å³æ²–å³ç”¨"], content: "å¯¦æ¸¬é¡¯ç¤º..." }
            ],
            products: [ {name: "åº·å¯¶é®®é›æ±", img: "https://placehold.co/100/FFD700/333?text=Chicken"}, {name: "åº·å¯¶éº»è¾£é†¬", img: "https://placehold.co/100/FF5700/FFF?text=Spicy"}, {name: "åº·å¯¶æ‰“æ‹‹é†¬", img: "https://placehold.co/100/00652B/FFF?text=Thai"} ],
            sop: { id:999, title:"3æ­¥é©Ÿå‡ºé¤ SOP", desc:"é‡å°ç¹å¿™å»šæˆ¿è¨­è¨ˆã€‚", steps:[{title:"å…èª¿å‘³",text:"ä½¿ç”¨å°ˆæ¥­é†¬æ–™"},{title:"é è£½",text:"çµ±ä¸€è¦æ ¼"},{title:"å¿«ç‚’",text:"å¤§ç«å‡ºé¤"}] },
            chef: { name:"æ±ŸæŒ¯èª ", desc:"ç±³å…¶æ—äºŒæ˜Ÿä¸»å»šï¼Œæ“…é•·é‹ç”¨åœ¨åœ°é£Ÿæï¼Œå°‡å‚³çµ±å·èœèˆ‡ç¾ä»£æŠ€æ³•çµåˆã€‚ç¨å®¶æˆæ¬Šåº·å¯¶é–‹ç™¼åå»šç³»åˆ—é†¬æ–™ã€‚", img:"https://placehold.co/800x400/333/FFF?text=Chef+Andre" }
        };

        // --- Core Router ---
        function router(page) {
            document.querySelectorAll('.nav-item').forEach((el,i)=>el.classList.toggle('active', i===['home','info','scan','recipes','shop'].indexOf(page)));
            const root = document.getElementById('app-root');
            window.scrollTo(0,0);
            if(page==='home') root.innerHTML = renderHeader(page)+renderHome();
            else if(page==='info') root.innerHTML = renderHeader(page)+renderInfo();
            else if(page==='recipes') root.innerHTML = renderHeader(page)+renderRecipes();
            else if(page==='scan') renderScanPage();
            else if(page==='shop') root.innerHTML = renderHeader(page)+renderShop();
        }

        function renderHeader(page) {
            let tabs = page==='home'?renderTabs(['ç‚ºä½ æ¨è–¦','åå»šæŠ€æ³•','æ‡¶äººåŒ…','ä½æˆæœ¬'],'home'):
                       page==='info'?renderTabs(['æœ€æ–°æƒ…å ±','ç¶“ç‡Ÿç®¡ç†','é¤é£²è¶¨å‹¢'],'info'):'';
            return `<header><div class="header-top"><div class="search-bar"><span class="material-symbols-outlined">search</span>æœå°‹...</div><span class="material-symbols-outlined icon-btn">notifications</span></div>${tabs}</header>`;
        }
        function renderTabs(l,c) { return `<div class="tab-bar"><div class="scrolling-wrapper">${l.map((t,i)=>`<div class="tab-chip ${i===0?'active':''}" onclick="filterList(this,'${t}','${c}')">${t}</div>`).join('')}</div></div>`; }

        // --- Pages ---
        function renderHome() {
            return `
            <div class="fade-in">
                <div style="padding:24px 16px 0;"><div style="font-size:12px;color:var(--primary);font-weight:700;">ğŸ‘‹ æ—©å®‰ï¼Œå¼µä¸»å»š</div><div style="font-size:22px;font-weight:800;color:#333;">ç‚ºä½ æ¨è–¦ï¼š<br>æ‡¶äººé£Ÿè­œ</div></div>
                <div class="section-header"><div class="section-title"><span class="material-symbols-outlined" style="color:var(--secondary)">new_releases</span> 1æœˆæ–°èœä¸Šæ¶</div></div>
                <div class="card-scroll-container">${db.recipes.filter(r=>r.date.includes('1æœˆ')).map(r=>renderCardV(r,true)).join('')}</div>
                <div class="section-header"><div class="section-title"><span class="material-symbols-outlined" style="color:#FFD700">emoji_events</span> ç†±é–€æ’è¡Œ</div></div>
                <div style="margin:0 16px;"><div class="ranking-tabs"><div class="ranking-tab active" onclick="switchRanking(this,'recipe')">å°ˆæ¥­é£Ÿè­œ</div><div class="ranking-tab" onclick="switchRanking(this,'info')">é¤é£²æƒ…å ±</div></div><div id="ranking-list">${renderRanking('recipe')}</div></div>
                <div style="padding:24px 16px;"><div onclick="openSOP()" style="background:linear-gradient(135deg,#6A1B9A,#4A148C);border-radius:16px;padding:24px;color:white;display:flex;align-items:center;gap:16px;box-shadow:var(--shadow-md);cursor:pointer;"><span class="material-symbols-outlined" style="font-size:32px;">bolt</span><div><div style="font-weight:700;font-size:16px;">3æ­¥é©Ÿå‡ºé¤ SOP</div><div style="font-size:12px;opacity:0.8;">åˆé¤é«˜å³°æ•‘æ˜Ÿ</div></div></div></div>
                <div class="section-header"><div class="section-title">ç²¾é¸æ¨è–¦</div></div><div id="home-list" class="card-scroll-container">${db.recipes.map(r=>renderCardV(r)).join('')}</div>
            </div>`;
        }
        function renderRecipes() {
            return `
                <div class="chef-banner fade-in" onclick="openChef()"><div style="z-index:1;"><div>ç±³å…¶æ—ä¸»å»š</div><div style="font-size:20px;font-weight:800;margin-top:4px;">æ±ŸæŒ¯èª  ç¨å®¶æˆæ¬Š</div></div><span class="material-symbols-outlined" style="font-size:48px;">restaurant_menu</span></div>
                <div class="strategy-cta-grid fade-in"><div class="strategy-btn btn-change" onclick="startWizard('change')"><div class="btn-icon-circle"><span class="material-symbols-outlined">restaurant_menu</span></div><span class="strategy-label">æˆ‘è¦æ›èœ</span><span class="strategy-sub">å­£ç¯€/ç¯€æ…¶</span></div><div class="strategy-btn btn-fast" onclick="startWizard('fast')"><div class="btn-icon-circle"><span class="material-symbols-outlined">timer</span></div><span class="strategy-label">å¿«é€Ÿå‡ºé¤</span><span class="strategy-sub">æ•ˆç‡/SOP</span></div></div>
                ${renderTabs(['å…¨éƒ¨','åå»šå°ˆå€','æ‡¶äººåŒ…','ä½æˆæœ¬'],'recipes')}
                <div id="recipe-list" class="recipe-grid fade-in">${db.recipes.map(r=>renderCardV(r)).join('')}</div>
            `;
        }
        function renderInfo() { return `<div id="info-list" class="fade-in" style="padding-top:16px;">${db.info.map(i=>renderListCard(i)).join('')}</div>`; }
        function renderScanPage() {
            document.getElementById('app-root').innerHTML = `
                <div class="scan-container fade-in">
                    <div class="scan-controls"><div class="toggle-btn" onclick="this.querySelector('.toggle-switch').classList.toggle('on')">é€£çºŒæƒææ¨¡å¼ <div class="toggle-switch"></div></div></div>
                    <div class="scan-viewfinder"><div class="scan-frame"></div><div class="toast" id="scan-toast"><span class="material-symbols-outlined">check_circle</span> æƒææˆåŠŸ +50é»</div><button onclick="simulateScan()" style="position:absolute;bottom:40px;background:rgba(255,255,255,0.2);color:white;border:1px solid rgba(255,255,255,0.5);padding:8px 16px;border-radius:20px;cursor:pointer;">æ¨¡æ“¬æƒæ</button></div>
                    <div class="rewards-panel"><div class="progress-header"><span class="points-text">ç›®å‰: 850é»</span><span class="goal-text">å·® 150 é»æ› $100</span></div><div class="progress-track"><div class="progress-fill"></div></div><div style="font-size:14px;font-weight:700;margin-bottom:12px;">å¿«é€Ÿå…Œæ› (v19)</div><div class="instant-rewards"><div class="reward-card">ğŸª 7-11</div><div class="reward-card">ğŸ’¬ Line Pts</div></div></div>
                </div>`;
        }
        function renderShop() { return `<div style="text-align:center;padding:60px;color:#999;">å•†åŸè¼‰å…¥ä¸­...</div>`; }

        // --- Interaction ---
        function filterList(el, filter, ctx) {
            el.parentElement.querySelectorAll('.tab-chip').forEach(c=>c.classList.remove('active')); el.classList.add('active');
            if(ctx==='recipes') {
                const k = {'å…¨éƒ¨':'all','åå»šå°ˆå€':'chef','æ‡¶äººåŒ…':'lazy','ä½æˆæœ¬':'low_cost'}[filter];
                document.getElementById('recipe-list').innerHTML = db.recipes.filter(r=>k==='all'||r.category.includes(k)).map(r=>renderCardV(r)).join('');
            } else if(ctx==='info') {
                const k = {'æœ€æ–°æƒ…å ±':'all','ç¶“ç‡Ÿç®¡ç†':'manage','é¤é£²è¶¨å‹¢':'trend'}[filter];
                document.getElementById('info-list').innerHTML = db.info.filter(i=>k==='all'||i.category===k).map(i=>renderListCard(i)).join('');
            } else if(ctx==='home') {
                const k = {'ç‚ºä½ æ¨è–¦':'all','åå»šæŠ€æ³•':'chef','æ‡¶äººåŒ…':'lazy','ä½æˆæœ¬':'low_cost'}[filter];
                document.getElementById('home-list').innerHTML = db.recipes.filter(r=>k==='all'||r.category.includes(k)).map(r=>renderCardV(r)).join('');
            }
        }
        function switchRanking(el, type) {
            el.parentElement.querySelectorAll('.ranking-tab').forEach(c=>c.classList.remove('active')); el.classList.add('active');
            document.getElementById('ranking-list').innerHTML = renderRanking(type);
        }
        function simulateScan() { document.getElementById('scan-toast').classList.add('show'); setTimeout(()=>document.getElementById('scan-toast').classList.remove('show'),2000); }

        // --- Renderers ---
        function renderCardV(r, badgeDate=false) {
            return `<div class="card" onclick="openDetail('recipe',${r.id})"><div class="card-img-wrapper"><div class="card-badge" style="${badgeDate?'background:var(--secondary)':''}">${badgeDate?r.date:r.type}</div><img class="card-img" src="${r.img}"></div><div class="card-content"><div class="card-title">${r.title}</div><div class="card-meta"><span class="meta-tag">ğŸ’° ${r.stats.cost}</span><span class="meta-tag">â± ${r.stats.time}</span><span class="meta-tag">ğŸ”¥ ${r.stats.diff}</span></div></div></div>`;
        }
        function renderListCard(i, rank) {
            return `<div class="list-card" onclick="openDetail('info',${i.id})">${rank?`<div class="rank-badge rank-${rank}">${rank}</div>`:''}<div style="flex:1;"><div style="font-size:12px;color:var(--primary);font-weight:700;">#${i.category.toUpperCase()} ${i.isNew?'<span style="color:red;">â— æ–°ä¸Šæ¶</span>':''}</div><div style="font-weight:700;margin-top:4px;">${i.title}</div><div style="font-size:12px;color:#888;">${i.views} é–±è®€</div></div><img class="list-card-img" src="${i.img}"></div>`;
        }
        function renderRanking(type) {
            const list = type==='recipe' ? db.recipes.slice(0,3) : db.info.slice(0,3);
            if(type==='recipe') return list.map((r,i)=>`<div class="list-card" onclick="openDetail('recipe',${r.id})"><div class="rank-badge rank-${i+1}">${i+1}</div><div style="flex:1;margin-left:8px;"><div style="font-weight:700;">${r.title}</div><div style="font-size:12px;color:#666;">${r.desc}</div></div><img class="list-card-img" src="${r.img}"></div>`).join('');
            return list.map((i,idx)=>renderListCard(i,idx+1)).join('');
        }

        // --- Wizard Logic (v12) ---
        let wizardState = { type: null, step: 0, selections: [] };
        const wizardConfig = { change: { title: "æˆ‘æƒ³æ›èœ", steps: [{ q: "è¨­å®šä¸»æ‰“æƒ…å¢ƒ", o: ["å†¬å­£é™å®š", "å¹´èœç‰¹é¤"] }, { q: "é¸æ“‡èœç³»é¢¨æ ¼", o: ["ä¸­å¼ç†±ç‚’", "è¥¿å¼æ’é¤"] }, { q: "é¸æ“‡æ ¸å¿ƒé£Ÿæ", o: ["é›è‚‰", "è±¬è‚‰"] }] }, fast: { title: "å¿«é€Ÿå‡ºé¤", steps: [{ q: "ç›®æ¨™å‡ºé¤æ™‚é–“", o: ["3 åˆ†é˜å…§", "5 åˆ†é˜å…§"] }, { q: "ç¾æœ‰çƒ¹èª¿è¨­å‚™", o: ["å¿«é€Ÿçˆ", "è’¸çƒ¤ç®±"] }] } };
        function startWizard(type) { wizardState = { type, step: 0, selections: [] }; document.getElementById('wizard-title').innerText = wizardConfig[type].title; renderWizardStep(); document.getElementById('wizard-content').style.display = 'block'; document.getElementById('wizard-loading').style.display = 'none'; document.getElementById('wizard-overlay').style.display = 'flex'; }
        function closeWizard() { document.getElementById('wizard-overlay').style.display = 'none'; }
        function renderWizardStep() { const d = wizardConfig[wizardState.type].steps[wizardState.step]; document.getElementById('wizard-content').innerHTML = `<div style="text-align:center;"><div style="font-size:20px;font-weight:700;margin-bottom:24px;">${d.q}</div><div class="wizard-option-grid">${d.o.map(opt => `<div class="wizard-option" onclick="handleOptionClick('${opt}')">${opt}</div>`).join('')}</div></div>`; document.getElementById('wizard-progress').innerHTML = wizardConfig[wizardState.type].steps.map((_,i)=>`<div class="progress-bar ${i<=wizardState.step?'active':''}"></div>`).join(''); }
        function handleOptionClick(sel) { wizardState.selections.push(sel); if (wizardState.step < wizardConfig[wizardState.type].steps.length - 1) { wizardState.step++; renderWizardStep(); } else { document.getElementById('wizard-content').style.display = 'none'; document.getElementById('wizard-loading').style.display = 'block'; setTimeout(() => { closeWizard(); renderRecommendationResults(wizardState.selections); }, 1500); } }
        function renderRecommendationResults(tags) {
            document.getElementById('app-root').innerHTML = `
                <header><div class="header-top"><span class="material-symbols-outlined icon-btn" onclick="router('recipes')">arrow_back</span><div style="flex:1;text-align:center;color:white;font-weight:700;">æ¨è–¦çµæœ</div><span style="width:24px;"></span></div></header>
                <div class="result-context fade-in"><div class="result-context-title"><span class="material-symbols-outlined" style="font-size:18px;">auto_awesome</span> ç‚ºæ‚¨æ¨è–¦ 10 é“æœ€ä½³æ–¹æ¡ˆ</div><div class="result-chips">${tags.map(t => `<div class="result-chip">${t}</div>`).join('')}</div></div>
                <div class="recipe-grid fade-in" style="padding-top:0;">${db.recipes.map(r => renderCardV(r)).join('')}</div>`;
            window.scrollTo(0,0);
        }

        // --- Detail & Comments ---
        function openDetail(type, id) {
            const content = document.getElementById('detail-content');
            document.getElementById('detail-img').src = (type==='recipe'?db.recipes:db.info).find(x=>x.id===id).img;
            document.querySelector('.progress-bar-top').style.display = type==='info'?'block':'none';
            document.getElementById('detail-view').style.display = 'block';
            document.body.style.overflow = 'hidden';
            
            let html = '';
            if(type==='recipe') {
                const r = db.recipes.find(x=>x.id===id);
                window.currentRecipeId = r.id;
                html = `
                    <div style="font-size:24px;font-weight:700;">${r.title}</div>
                    <div class="info-grid"><div class="info-box"><div class="info-label">æˆæœ¬</div><div class="info-value">${r.stats.cost}</div></div><div class="info-box"><div class="info-label">æ™‚é–“</div><div class="info-value">${r.stats.time}</div></div><div class="info-box"><div class="info-label">é›£åº¦</div><div class="info-value">${r.stats.diff}</div></div></div>
                    <h3 class="section-header-detail">æ‰€éœ€ææ–™</h3><div class="ing-group">${r.ingredients.map(ing=>`<div class="ing-item" onclick="this.firstChild.classList.toggle('checked')"><div class="checkbox-circle"></div><span>${ing}</span></div>`).join('')}</div>
                    <h3 class="section-header-detail">çƒ¹èª¿æ­¥é©Ÿ</h3>${r.steps.map((s,i)=>`<div class="step-row"><div class="step-idx">${i+1}</div><div style="flex:1;"><div style="font-weight:700;margin-bottom:4px;">${s.t}</div><div style="color:#555;">${s.c}</div></div></div>`).join('')}
                    <div class="step-tip"><span class="material-symbols-outlined">lightbulb</span> <div><strong>ä¸»å»š Tipsï¼š</strong> ${r.tips}</div></div>
                    ${r.multiUse?`<h3 class="section-header-detail">ä¸€é†¬å¤šç”¨</h3><div class="card-scroll-container">${r.multiUse.map(m=>`<div class="rp-card"><div>${m.name}</div><div style="color:var(--primary);font-weight:700;">${m.cost}</div></div>`).join('')}</div>`:''}
                    ${r.qa?`<h3 class="section-header-detail">Q&A</h3><div style="background:#f9f9f9;padding:16px;border-radius:12px;">${r.qa.map(q=>`<div style="margin-bottom:8px;"><strong>Q: ${q.q}</strong><div style="color:#666;">A: ${q.a}</div></div>`).join('')}</div>`:''}
                    <div class="comment-section"><div class="section-title" style="padding-left:0;">ä¸»å»šè©•è«–å€</div><div id="comments-container">${renderComments(r.comments)}</div><div class="comment-input-area"><input type="text" id="comment-input" class="comment-input" style="width:100%;border:none;background:transparent;outline:none;" placeholder="æ’°å¯«è©•è«–..."><button class="btn-submit" onclick="addComment()">é€å‡º</button></div></div>`;
            } else if(type==='info') {
                const i = db.info.find(x=>x.id===id);
                const longContent = i.content + "<br><br>" + i.content + "<br><br>" + i.content;
                html = `<div style="font-size:22px;font-weight:700;margin-bottom:12px;">${i.title}</div><div class="tldr-box"><div class="tldr-header" onclick="this.nextElementSibling.style.display=this.nextElementSibling.style.display==='none'?'block':'none'"><span>âš¡ é‡é»æ‘˜è¦</span><span class="material-symbols-outlined">expand_more</span></div><div class="tldr-body show" style="padding-top:10px;">${i.tldr.map(t=>`<div>â€¢ ${t}</div>`).join('')}</div></div><div style="line-height:1.8;">${longContent}</div>`;
            }
            html += `<div class="related-products"><div class="section-title" style="padding-left:0;">ç›¸é—œç”¢å“</div><div class="card-scroll-container">${db.products.map(p=>`<div class="rp-card"><img class="rp-img" src="${p.img}"><div style="font-size:12px;">${p.name}</div></div>`).join('')}</div></div>`;
            content.innerHTML = html;
        }

        function openSOP() {
            const s = db.sop;
            document.getElementById('detail-img').src = s.img;
            document.getElementById('detail-content').innerHTML = `<div style="font-size:24px;font-weight:700;">${s.title}</div><div style="background:#F3E5F5;padding:16px;border-radius:12px;margin:16px 0;color:#4A148C;">${s.desc}</div>${s.steps.map((st,i)=>`<div style="margin-bottom:16px;"><div style="font-weight:700;">${i+1}. ${st.title}</div><div style="font-size:13px;color:#666;">${st.text}</div></div>`).join('')}`;
            document.getElementById('detail-view').style.display='block';
        }
        function openChef() {
            const c = db.chef;
            document.getElementById('detail-img').src = c.img;
            document.getElementById('detail-content').innerHTML = `<div style="font-size:24px;font-weight:700;">${c.name}</div><div style="margin-top:16px;color:#555;">${c.desc}</div><h3 class="section-header-detail">ä¸»å»šæ¨è–¦é£Ÿè­œ</h3><div class="recipe-grid" style="padding:0;">${db.recipes.filter(r=>r.type==='åå»š').map(r=>renderCardV(r)).join('')}</div>`;
            document.getElementById('detail-view').style.display='block';
        }

        function closeDetail() { document.getElementById('detail-view').style.display = 'none'; document.body.style.overflow = 'auto'; }
        function updateProgress() { const el = document.getElementById('detail-view'); document.getElementById('read-progress').style.width = (el.scrollTop / (el.scrollHeight - el.clientHeight)) * 100 + '%'; }

        // --- Comments ---
        function renderComments(comments) {
            if(!comments||!comments.length) return '<div style="color:#999;font-size:13px;">å°šç„¡è©•è«–ã€‚</div>';
            return comments.map((c,i) => `
                <div class="comment-item">
                    <div class="comment-avatar">${c.user[0]}</div>
                    <div class="comment-body">
                        <div class="comment-name">${c.user}</div>
                        <div class="comment-meta"><span class="comment-stars">${'â˜…'.repeat(c.star)}</span> <span>${c.date}</span></div>
                        <div class="comment-text">${c.text}</div>
                        <div class="comment-actions">
                            ${c.user==='æˆ‘'?`<div class="action-chip" onclick="delCom(${i})"><span class="material-symbols-outlined" style="font-size:14px;">delete</span> åˆªé™¤</div>`:`<div class="action-chip"><span class="material-symbols-outlined" style="font-size:14px;">thumb_up</span> æœ‰å¹«åŠ©</div>`}
                        </div>
                    </div>
                </div>`).join('');
        }
        function addComment() { const t=document.getElementById('comment-input').value; if(t){ const r=db.recipes.find(x=>x.id===window.currentRecipeId); r.comments.unshift({user:"æˆ‘",star:5,text:t,date:"å‰›å‰›"}); document.getElementById('comments-container').innerHTML=renderComments(r.comments); document.getElementById('comment-input').value=''; } }
        function delCom(i) { const r=db.recipes.find(x=>x.id===window.currentRecipeId); r.comments.splice(i,1); document.getElementById('comments-container').innerHTML=renderComments(r.comments); }

        router('home');
    </script>
</body>
</html>